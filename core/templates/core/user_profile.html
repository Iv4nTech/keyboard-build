{% extends 'core/base.html' %}
{% load static %}

{% block tittle_bar %}User profile @{{user_profile.username}}{% endblock %}
{% block tittle_section %}User profile{% endblock %}

{% block content %}

{% if messages %}
{% for message in messages %}
<div class="message {{message.tags}}">
    {{message}}
</div>
{% endfor %}
{% endif %}

<div class="profile-card">

    <div class="profile-glow-effect"></div>

    <div class="profile-content">
        <div class="avatar-container">
            {% if user_profile.image %}
            <img class="profile-img-large" src="{{user.image.url}}" alt="Foto de perfil">
            {% else %}
            <img class="profile-img-large" src="{% static 'images/logo-default.jpg' %}" alt="Logo default">
            {% endif %}

            <div class="status-indicator"></div>
        </div>

        <h2 class="profile-username">@{{user_profile.username}}</h2>

        <p class="profile-bio">{{user_profile.bio | default:""}}</p>

        <div class="expand-trigger-container">
            <h3 id="more-abaut" class="expand-trigger">
                More about me +
            </h3>
        </div>

        <ul hidden id="detail-abaut" class="expand-content">
            <li class="expand-item">
                <span style="color: var(--text-muted);">First Name</span>
                <span style="color: var(--text-main);">{{user_profile.first_name | default:'Not available'}}</span>
            </li>
            <li class="expand-item">
                <span style="color: var(--text-muted);">Last Name</span>
                <span style="color: var(--text-main);">{{user_profile.last_name | default:'Not available'}}</span>
            </li>
            <li class="expand-item">
                <span style="color: var(--text-muted);">Birth Date</span>
                <span style="color: var(--text-main);">{{user_profile.dateofbirth | default:'Not available'}}</span>
            </li>
            <li class="expand-item">
                <span style="color: var(--text-muted);">Country</span>
                <span style="color: var(--text-main);">{{user_profile.country | default:'Not available'}}</span>
            </li>
        </ul>
    </div>
</div>

<div class="section-spacer">

    <div class="section-header">
        <h3 class="section-title">Keyboards</h3>
        {% if user.username == user_profile.username %}
        <a href="{% url 'create_keyboard' %}" class="btn">Add keyboard +</a>
        {% endif %}
    </div>

    <ul class="user-grid">
        {% for keyboard in keyboards %}
        <li class="product-card">
            <a href="{% url 'detail_keyboard' keyboard.pk %}" class="card-link">
                {% if keyboard.image %}
                <div style="height: 200px; width: 100%; overflow: hidden; border-radius: 8px; margin-bottom: 1rem;">
                    <img src="{{keyboard.image.url}}" alt="{{keyboard.name}}"
                        style="width: 100%; height: 100%; object-fit: cover;">
                </div>
                {% else %}
                <div
                    style="height: 200px; width: 100%; background-color: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; border-radius: 8px; margin-bottom: 1rem;">
                    <span class="text-muted">No image</span>
                </div>
                {% endif %}
                <div class="product-header">
                    <h3 class="product-title">{{keyboard.name}}</h3>
                    <span class="price-tag">{{keyboard.price}}€</span>
                </div>

                <div class="rating-box">
                    <span class="star-icon">★</span>
                    <span class="rating-value">{{keyboard.stars}}</span>
                    <span class="rating-max">/ 5</span>
                </div>

                <div class="product-divider"></div>

                <div class="product-footer">
                    <span class="product-label">Colours</span>
                    <div class="pill-tag">{{keyboard.colours}}</div>
                </div>
            </a>
        </li>
        {% empty %}
        <div class="empty-state">
            <p>User not have keyboards.</p>
        </div>
        {% endfor %}
    </ul>
</div>

<div style="text-align: center; margin-top: 3rem; margin-bottom: 2rem;">
    <a class="btn" href="{% url 'view_keyboards' user_profile.username %}">View All Keyboards &rarr;</a>
</div>

<script src="{% static 'js/more_abaut.js' %}"></script>
{% endblock %}