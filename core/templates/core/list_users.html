{% extends 'core/base.html' %}
{% load static %}
{% block tittle_bar %}User list{% endblock %}
{% block tittle_section %}Discover users{% endblock %}
{% block content %}

<form action="" method="get" class="search-bar">
    <div style="flex: 1;">
        <label for="username">Username</label>
        <input type="text" name="username" id="username" placeholder="Buscar usuario...">
    </div>
    <div style="width: 120px;">
        <label for="level">Level</label>
        <input type="number" name="level" id="level">
    </div>
    <button type="submit">Buscar</button>
    <a href="{% url 'list_users' %}" class="btn btn-ghost" style="padding: 0.8rem;">âœ•</a>
</form>

<ul class="user-grid">
{% for user in page_obj %}
    <li class="user-card">
        <a href="{% url 'user_profile' user.username %}" style="display: flex; align-items: center; gap: 15px; width: 100%;">
            <div class="user-initial">
                {% if user.image %}
                <img class="avatar"  src="{{user.image.url}}" alt="Logo {{user.username}}">
                {% else %}
                <img class="avatar" src="{% static 'images/logo-default.jpg' %}" alt="Logo default">
                {% endif %}
            </div>
            <div>
                <h3 style="font-weight: 600; color: #fff;">{{user.username}}</h3>
                <span style="font-size: 0.8rem; color: var(--text-muted);">Ver perfil</span>
            </div>
        </a>
    </li>
    {% endfor %}
</ul>

{% if page_obj.has_previous %}
  <a class="btn" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ page_obj.previous_page_number }}">Anterior</a>
{% endif %}

{% if page_obj.paginator.num_pages > 1 %}
{% for number in page_obj.paginator.page_range %}
{% if number == page_obj.number %}
<a class="pagination-btn number-selected" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{number}}">
    {{ number }}
</a>
{% else %}
<a class="btn btn-ghost" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{number}}">
    {{ number }}
</a>
{% endif %}
{% endfor %}
{% endif %}
{% if page_obj.has_next %}
  <a class="btn" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ page_obj.next_page_number }}">Siguiente</a>
{% endif %}
{% endblock %}